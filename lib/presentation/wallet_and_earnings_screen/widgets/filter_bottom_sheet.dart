import 'package:flutter/material.dart';import 'package:sizer/sizer.dart';import '../../../core/app_export.dart';class FilterBottomSheet extends StatefulWidget {  final Map<String, dynamic> currentFilters;  final Function(Map<String, dynamic>) onApplyFilters;  const FilterBottomSheet({    super.key,    required this.currentFilters,    required this.onApplyFilters,  });  @override  State<FilterBottomSheet> createState() => _FilterBottomSheetState();}class _FilterBottomSheetState extends State<FilterBottomSheet> {  late Map<String, dynamic> _filters;  final List<String> _transactionTypes = [    'All',    'Chat',    'Audio',    'Video',    'Report',    'Withdrawal',    'Refund',    'Bonus',  ];  final List<String> _statusTypes = [    'All',    'Completed',    'Pending',    'Failed',    'Processing',  ];  final List<String> _dateRanges = [    'All Time',    'Today',    'This Week',    'This Month',    'Last Month',    'Last 3 Months',    'Custom Range',  ];  @override  void initState() {    super.initState();    _filters = Map<String, dynamic>.from(widget.currentFilters);  }  @override  Widget build(BuildContext context) {    final theme = Theme.of(context);    return Container(      height: 80.h,      decoration: BoxDecoration(        color: theme.colorScheme.surface,        borderRadius: const BorderRadius.vertical(top: Radius.circular(20)),      ),      child: Column(        children: [          _buildHeader(context),          Expanded(            child: SingleChildScrollView(              padding: EdgeInsets.symmetric(horizontal: 4.w),              child: Column(                crossAxisAlignment: CrossAxisAlignment.start,                children: [                  _buildTransactionTypeFilter(context),                  SizedBox(height: 3.h),                  _buildStatusFilter(context),                  SizedBox(height: 3.h),                  _buildDateRangeFilter(context),                  SizedBox(height: 3.h),                  _buildAmountRangeFilter(context),                  SizedBox(height: 4.h),                ],              ),            ),          ),          _buildActionButtons(context),        ],      ),    );  }  Widget _buildHeader(BuildContext context) {    final theme = Theme.of(context);    return Container(      padding: EdgeInsets.all(4.w),      decoration: BoxDecoration(        border: Border(          bottom: BorderSide(            color: theme.colorScheme.outline.withValues(alpha: 0.1),            width: 1,          ),        ),      ),      child: Row(        children: [          Expanded(            child: Text(              'Filter Transactions',              style: theme.textTheme.titleLarge?.copyWith(                fontWeight: FontWeight.w600,              ),            ),          ),          IconButton(            onPressed: () => Navigator.pop(context),            icon: CustomIconWidget(              iconName: 'close',              color: theme.colorScheme.onSurface,              size: 24,            ),          ),        ],      ),    );  }  Widget _buildTransactionTypeFilter(BuildContext context) {    final theme = Theme.of(context);    return Column(      crossAxisAlignment: CrossAxisAlignment.start,      children: [        Text(          'Transaction Type',          style: theme.textTheme.titleSmall?.copyWith(            fontWeight: FontWeight.w600,          ),        ),        SizedBox(height: 2.h),        Wrap(          spacing: 2.w,          runSpacing: 1.h,          children: _transactionTypes.map((type) {            final isSelected = (_filters['transactionType'] as String?) == type;            return GestureDetector(              onTap: () {                setState(() {                  _filters['transactionType'] = type;                });              },              child: Container(                padding: EdgeInsets.symmetric(horizontal: 4.w, vertical: 1.5.h),                decoration: BoxDecoration(                  color: isSelected                      ? theme.colorScheme.primary                      : AppTheme.getAccentColor(context),                  borderRadius: BorderRadius.circular(20),                  border: Border.all(                    color: isSelected                        ? theme.colorScheme.primary                        : theme.colorScheme.outline.withValues(alpha: 0.2),                    width: 1,                  ),                ),                child: Text(                  type,                  style: theme.textTheme.labelMedium?.copyWith(                    color: isSelected                        ? theme.colorScheme.onPrimary                        : theme.colorScheme.onSurface,                    fontWeight: FontWeight.w500,                  ),                ),              ),            );          }).toList(),        ),      ],    );  }  Widget _buildStatusFilter(BuildContext context) {    final theme = Theme.of(context);    return Column(      crossAxisAlignment: CrossAxisAlignment.start,      children: [        Text(          'Status',          style: theme.textTheme.titleSmall?.copyWith(            fontWeight: FontWeight.w600,          ),        ),        SizedBox(height: 2.h),        Wrap(          spacing: 2.w,          runSpacing: 1.h,          children: _statusTypes.map((status) {            final isSelected = (_filters['status'] as String?) == status;            return GestureDetector(              onTap: () {                setState(() {                  _filters['status'] = status;                });              },              child: Container(                padding: EdgeInsets.symmetric(horizontal: 4.w, vertical: 1.5.h),                decoration: BoxDecoration(                  color: isSelected                      ? theme.colorScheme.primary                      : AppTheme.getAccentColor(context),                  borderRadius: BorderRadius.circular(20),                  border: Border.all(                    color: isSelected                        ? theme.colorScheme.primary                        : theme.colorScheme.outline.withValues(alpha: 0.2),                    width: 1,                  ),                ),                child: Text(                  status,                  style: theme.textTheme.labelMedium?.copyWith(                    color: isSelected                        ? theme.colorScheme.onPrimary                        : theme.colorScheme.onSurface,                    fontWeight: FontWeight.w500,                  ),                ),              ),            );          }).toList(),        ),      ],    );  }  Widget _buildDateRangeFilter(BuildContext context) {    final theme = Theme.of(context);    return Column(      crossAxisAlignment: CrossAxisAlignment.start,      children: [        Text(          'Date Range',          style: theme.textTheme.titleSmall?.copyWith(            fontWeight: FontWeight.w600,          ),        ),        SizedBox(height: 2.h),        Wrap(          spacing: 2.w,          runSpacing: 1.h,          children: _dateRanges.map((range) {            final isSelected = (_filters['dateRange'] as String?) == range;            return GestureDetector(              onTap: () {                setState(() {                  _filters['dateRange'] = range;                });              },              child: Container(                padding: EdgeInsets.symmetric(horizontal: 4.w, vertical: 1.5.h),                decoration: BoxDecoration(                  color: isSelected                      ? theme.colorScheme.primary                      : AppTheme.getAccentColor(context),                  borderRadius: BorderRadius.circular(20),                  border: Border.all(                    color: isSelected                        ? theme.colorScheme.primary                        : theme.colorScheme.outline.withValues(alpha: 0.2),                    width: 1,                  ),                ),                child: Text(                  range,                  style: theme.textTheme.labelMedium?.copyWith(                    color: isSelected                        ? theme.colorScheme.onPrimary                        : theme.colorScheme.onSurface,                    fontWeight: FontWeight.w500,                  ),                ),              ),            );          }).toList(),        ),      ],    );  }  Widget _buildAmountRangeFilter(BuildContext context) {    final theme = Theme.of(context);    final minAmount = (_filters['minAmount'] as double?) ?? 0.0;    final maxAmount = (_filters['maxAmount'] as double?) ?? 5000.0;    return Column(      crossAxisAlignment: CrossAxisAlignment.start,      children: [        Text(          'Amount Range',          style: theme.textTheme.titleSmall?.copyWith(            fontWeight: FontWeight.w600,          ),        ),        SizedBox(height: 2.h),        Row(          children: [            Expanded(              child: TextFormField(                initialValue: minAmount.toStringAsFixed(0),                decoration: InputDecoration(                  labelText: 'Min Amount',                  prefixText: '\$',                  border: OutlineInputBorder(                    borderRadius: BorderRadius.circular(8),                  ),                ),                keyboardType: TextInputType.number,                onChanged: (value) {                  final amount = double.tryParse(value) ?? 0.0;                  setState(() {                    _filters['minAmount'] = amount;                  });                },              ),            ),            SizedBox(width: 4.w),            Expanded(              child: TextFormField(                initialValue: maxAmount.toStringAsFixed(0),                decoration: InputDecoration(                  labelText: 'Max Amount',                  prefixText: '\$',                  border: OutlineInputBorder(                    borderRadius: BorderRadius.circular(8),                  ),                ),                keyboardType: TextInputType.number,                onChanged: (value) {                  final amount = double.tryParse(value) ?? 5000.0;                  setState(() {                    _filters['maxAmount'] = amount;                  });                },              ),            ),          ],        ),        SizedBox(height: 2.h),        RangeSlider(          values: RangeValues(minAmount, maxAmount),          min: 0,          max: 5000,          divisions: 50,          labels: RangeLabels(            '\$${minAmount.toStringAsFixed(0)}',            '\$${maxAmount.toStringAsFixed(0)}',          ),          onChanged: (RangeValues values) {            setState(() {              _filters['minAmount'] = values.start;              _filters['maxAmount'] = values.end;            });          },        ),      ],    );  }  Widget _buildActionButtons(BuildContext context) {    final theme = Theme.of(context);    return Container(      padding: EdgeInsets.all(4.w),      decoration: BoxDecoration(        border: Border(          top: BorderSide(            color: theme.colorScheme.outline.withValues(alpha: 0.1),            width: 1,          ),        ),      ),      child: Row(        children: [          Expanded(            child: OutlinedButton(              onPressed: () {                setState(() {                  _filters = {                    'transactionType': 'All',                    'status': 'All',                    'dateRange': 'All Time',                    'minAmount': 0.0,                    'maxAmount': 5000.0,                  };                });              },              child: const Text('Reset'),            ),          ),          SizedBox(width: 4.w),          Expanded(            flex: 2,            child: ElevatedButton(              onPressed: () {                widget.onApplyFilters(_filters);                Navigator.pop(context);              },              child: const Text('Apply Filters'),            ),          ),        ],      ),    );  }}