import 'package:flutter/material.dart';import 'package:sizer/sizer.dart';import '../../../core/app_export.dart';class DocumentUploadCard extends StatefulWidget {  final String title;  final String description;  final List<String> acceptedFormats;  final bool isRequired;  final DocumentStatus status;  final String? rejectionReason;  final VoidCallback onUpload;  final VoidCallback? onRetry;  final String? uploadedFileName;  const DocumentUploadCard({    super.key,    required this.title,    required this.description,    required this.acceptedFormats,    required this.isRequired,    required this.status,    this.rejectionReason,    required this.onUpload,    this.onRetry,    this.uploadedFileName,  });  @override  State<DocumentUploadCard> createState() => _DocumentUploadCardState();}class _DocumentUploadCardState extends State<DocumentUploadCard>    with SingleTickerProviderStateMixin {  late AnimationController _animationController;  late Animation<double> _expandAnimation;  bool _isExpanded = false;  @override  void initState() {    super.initState();    _animationController = AnimationController(      duration: const Duration(milliseconds: 300),      vsync: this,    );    _expandAnimation = CurvedAnimation(      parent: _animationController,      curve: Curves.easeInOut,    );  }  @override  void dispose() {    _animationController.dispose();    super.dispose();  }  void _toggleExpanded() {    setState(() {      _isExpanded = !_isExpanded;      _isExpanded          ? _animationController.forward()          : _animationController.reverse();    });  }  Color _getStatusColor() {    switch (widget.status) {      case DocumentStatus.pending:        return AppTheme.getWarningColor(context);      case DocumentStatus.underReview:        return AppTheme.lightTheme.primaryColor;      case DocumentStatus.approved:        return AppTheme.getSuccessColor(context);      case DocumentStatus.rejected:        return Theme.of(context).colorScheme.error;      case DocumentStatus.notUploaded:        return Theme.of(context).colorScheme.onSurfaceVariant;    }  }  IconData _getStatusIcon() {    switch (widget.status) {      case DocumentStatus.pending:        return Icons.schedule;      case DocumentStatus.underReview:        return Icons.visibility;      case DocumentStatus.approved:        return Icons.check_circle;      case DocumentStatus.rejected:        return Icons.error;      case DocumentStatus.notUploaded:        return Icons.upload_file;    }  }  String _getStatusText() {    switch (widget.status) {      case DocumentStatus.pending:        return 'Pending Upload';      case DocumentStatus.underReview:        return 'Under Review';      case DocumentStatus.approved:        return 'Approved';      case DocumentStatus.rejected:        return 'Rejected';      case DocumentStatus.notUploaded:        return 'Not Uploaded';    }  }  @override  Widget build(BuildContext context) {    final theme = Theme.of(context);    return Card(      margin: EdgeInsets.symmetric(horizontal: 4.w, vertical: 1.h),      child: Column(        children: [          InkWell(            onTap: _toggleExpanded,            borderRadius: BorderRadius.circular(12),            child: Padding(              padding: EdgeInsets.all(4.w),              child: Row(                children: [                  Container(                    width: 12.w,                    height: 6.h,                    decoration: BoxDecoration(                      color: _getStatusColor().withValues(alpha: 0.1),                      borderRadius: BorderRadius.circular(8),                    ),                    child: CustomIconWidget(                      iconName: _getStatusIcon().codePoint.toString(),                      color: _getStatusColor(),                      size: 24,                    ),                  ),                  SizedBox(width: 3.w),                  Expanded(                    child: Column(                      crossAxisAlignment: CrossAxisAlignment.start,                      children: [                        Row(                          children: [                            Expanded(                              child: Text(                                widget.title,                                style: theme.textTheme.titleMedium?.copyWith(                                  fontWeight: FontWeight.w600,                                ),                                overflow: TextOverflow.ellipsis,                              ),                            ),                            if (widget.isRequired)                              Container(                                padding: EdgeInsets.symmetric(                                  horizontal: 2.w,                                  vertical: 0.5.h,                                ),                                decoration: BoxDecoration(                                  color: theme.colorScheme.error                                      .withValues(alpha: 0.1),                                  borderRadius: BorderRadius.circular(4),                                ),                                child: Text(                                  'Required',                                  style: theme.textTheme.labelSmall?.copyWith(                                    color: theme.colorScheme.error,                                    fontWeight: FontWeight.w500,                                  ),                                ),                              ),                          ],                        ),                        SizedBox(height: 0.5.h),                        Row(                          children: [                            Expanded(                              child: Text(                                _getStatusText(),                                style: theme.textTheme.bodySmall?.copyWith(                                  color: _getStatusColor(),                                  fontWeight: FontWeight.w500,                                ),                              ),                            ),                            CustomIconWidget(                              iconName:                              _isExpanded ? 'expand_less' : 'expand_more',                              color: theme.colorScheme.onSurfaceVariant,                              size: 20,                            ),                          ],                        ),                      ],                    ),                  ),                ],              ),            ),          ),          AnimatedBuilder(            animation: _expandAnimation,            builder: (context, child) {              return ClipRect(                child: Align(                  alignment: Alignment.topCenter,                  heightFactor: _expandAnimation.value,                  child: child,                ),              );            },            child: Container(              width: double.infinity,              padding: EdgeInsets.fromLTRB(4.w, 0, 4.w, 4.w),              child: Column(                crossAxisAlignment: CrossAxisAlignment.start,                children: [                  Divider(                    color: theme.colorScheme.outline.withValues(alpha: 0.3),                    height: 1,                  ),                  SizedBox(height: 2.h),                  Text(                    widget.description,                    style: theme.textTheme.bodyMedium?.copyWith(                      color: theme.colorScheme.onSurfaceVariant,                    ),                  ),                  SizedBox(height: 2.h),                  Text(                    'Accepted Formats:',                    style: theme.textTheme.labelMedium?.copyWith(                      fontWeight: FontWeight.w600,                    ),                  ),                  SizedBox(height: 1.h),                  Wrap(                    spacing: 2.w,                    runSpacing: 1.h,                    children: widget.acceptedFormats.map((format) {                      return Container(                        padding: EdgeInsets.symmetric(                          horizontal: 3.w,                          vertical: 0.5.h,                        ),                        decoration: BoxDecoration(                          color: theme.colorScheme.primaryContainer,                          borderRadius: BorderRadius.circular(16),                        ),                        child: Text(                          format.toUpperCase(),                          style: theme.textTheme.labelSmall?.copyWith(                            color: theme.colorScheme.onPrimaryContainer,                            fontWeight: FontWeight.w500,                          ),                        ),                      );                    }).toList(),                  ),                  if (widget.uploadedFileName != null) ...[                    SizedBox(height: 2.h),                    Container(                      padding: EdgeInsets.all(3.w),                      decoration: BoxDecoration(                        color: AppTheme.getAccentColor(context),                        borderRadius: BorderRadius.circular(8),                        border: Border.all(                          color:                          theme.colorScheme.outline.withValues(alpha: 0.3),                        ),                      ),                      child: Row(                        children: [                          CustomIconWidget(                            iconName: 'description',                            color: theme.colorScheme.primary,                            size: 20,                          ),                          SizedBox(width: 2.w),                          Expanded(                            child: Text(                              widget.uploadedFileName!,                              style: theme.textTheme.bodySmall,                              overflow: TextOverflow.ellipsis,                            ),                          ),                        ],                      ),                    ),                  ],                  if (widget.status == DocumentStatus.rejected &&                      widget.rejectionReason != null) ...[                    SizedBox(height: 2.h),                    Container(                      padding: EdgeInsets.all(3.w),                      decoration: BoxDecoration(                        color: theme.colorScheme.errorContainer,                        borderRadius: BorderRadius.circular(8),                      ),                      child: Row(                        crossAxisAlignment: CrossAxisAlignment.start,                        children: [                          CustomIconWidget(                            iconName: 'info',                            color: theme.colorScheme.error,                            size: 20,                          ),                          SizedBox(width: 2.w),                          Expanded(                            child: Column(                              crossAxisAlignment: CrossAxisAlignment.start,                              children: [                                Text(                                  'Rejection Reason:',                                  style: theme.textTheme.labelMedium?.copyWith(                                    color: theme.colorScheme.error,                                    fontWeight: FontWeight.w600,                                  ),                                ),                                SizedBox(height: 0.5.h),                                Text(                                  widget.rejectionReason!,                                  style: theme.textTheme.bodySmall?.copyWith(                                    color: theme.colorScheme.onErrorContainer,                                  ),                                ),                              ],                            ),                          ),                        ],                      ),                    ),                  ],                  SizedBox(height: 3.h),                  SizedBox(                    width: double.infinity,                    child: widget.status == DocumentStatus.rejected &&                        widget.onRetry != null                        ? ElevatedButton.icon(                      onPressed: widget.onRetry,                      icon: CustomIconWidget(                        iconName: 'refresh',                        color: theme.colorScheme.onPrimary,                        size: 18,                      ),                      label: const Text('Retry Upload'),                    )                        : widget.status == DocumentStatus.approved                        ? OutlinedButton.icon(                      onPressed: null,                      icon: CustomIconWidget(                        iconName: 'check_circle',                        color: AppTheme.getSuccessColor(context),                        size: 18,                      ),                      label: const Text('Approved'),                    )                        : ElevatedButton.icon(                      onPressed: widget.onUpload,                      icon: CustomIconWidget(                        iconName: 'upload_file',                        color: theme.colorScheme.onPrimary,                        size: 18,                      ),                      label: Text(                        widget.uploadedFileName != null                            ? 'Replace Document'                            : 'Upload Document',                      ),                    ),                  ),                ],              ),            ),          ),        ],      ),    );  }}enum DocumentStatus {  notUploaded,  pending,  underReview,  approved,  rejected,}