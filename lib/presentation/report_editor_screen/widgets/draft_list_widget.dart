import 'package:flutter/material.dart';import 'package:sizer/sizer.dart';import '../../../core/app_export.dart';import '../../../widgets/custom_icon_widget.dart';class DraftListWidget extends StatelessWidget {  final List<Map<String, dynamic>> drafts;  final Function(Map<String, dynamic>) onDraftSelected;  final Function(Map<String, dynamic>) onDraftDeleted;  const DraftListWidget({    super.key,    required this.drafts,    required this.onDraftSelected,    required this.onDraftDeleted,  });  @override  Widget build(BuildContext context) {    final theme = Theme.of(context);    if (drafts.isEmpty) {      return Container(        padding: EdgeInsets.all(8.w),        child: Column(          mainAxisAlignment: MainAxisAlignment.center,          children: [            CustomIconWidget(              iconName: 'draft',              color: theme.colorScheme.onSurfaceVariant,              size: 48,            ),            SizedBox(height: 2.h),            Text(              'No drafts yet',              style: theme.textTheme.titleMedium?.copyWith(                color: theme.colorScheme.onSurfaceVariant,              ),            ),            SizedBox(height: 1.h),            Text(              'Your draft reports will appear here',              style: theme.textTheme.bodySmall?.copyWith(                color: theme.colorScheme.onSurfaceVariant,              ),              textAlign: TextAlign.center,            ),          ],        ),      );    }    return ListView.separated(      padding: EdgeInsets.all(4.w),      itemCount: drafts.length,      separatorBuilder: (context, index) => SizedBox(height: 2.h),      itemBuilder: (context, index) {        final draft = drafts[index];        return _buildDraftCard(context, draft);      },    );  }  Widget _buildDraftCard(BuildContext context, Map<String, dynamic> draft) {    final theme = Theme.of(context);    final clientName = draft['clientName'] as String;    final reportType = draft['reportType'] as String;    final lastModified = draft['lastModified'] as DateTime;    final wordCount = draft['wordCount'] as int;    final progress = draft['progress'] as double;    final now = DateTime.now();    final difference = now.difference(lastModified);    String timeAgo;    if (difference.inMinutes < 1) {      timeAgo = 'Just now';    } else if (difference.inMinutes < 60) {      timeAgo = '${difference.inMinutes}m ago';    } else if (difference.inHours < 24) {      timeAgo = '${difference.inHours}h ago';    } else {      timeAgo = '${difference.inDays}d ago';    }    return Card(      child: InkWell(        onTap: () => onDraftSelected(draft),        borderRadius: BorderRadius.circular(12),        child: Padding(          padding: EdgeInsets.all(4.w),          child: Column(            crossAxisAlignment: CrossAxisAlignment.start,            children: [              Row(                children: [                  Expanded(                    child: Column(                      crossAxisAlignment: CrossAxisAlignment.start,                      children: [                        Text(                          clientName,                          style: theme.textTheme.titleMedium?.copyWith(                            fontWeight: FontWeight.w600,                          ),                        ),                        SizedBox(height: 0.5.h),                        Container(                          padding: EdgeInsets.symmetric(                              horizontal: 2.w, vertical: 0.5.h),                          decoration: BoxDecoration(                            color: theme.colorScheme.primary                                .withValues(alpha: 0.1),                            borderRadius: BorderRadius.circular(6),                          ),                          child: Text(                            reportType,                            style: theme.textTheme.labelSmall?.copyWith(                              color: theme.colorScheme.primary,                              fontWeight: FontWeight.w500,                            ),                          ),                        ),                      ],                    ),                  ),                  PopupMenuButton<String>(                    onSelected: (value) {                      if (value == 'delete') {                        _showDeleteConfirmation(context, draft);                      }                    },                    itemBuilder: (context) => [                      PopupMenuItem(                        value: 'delete',                        child: Row(                          children: [                            CustomIconWidget(                              iconName: 'delete',                              color: theme.colorScheme.error,                              size: 16,                            ),                            SizedBox(width: 2.w),                            Text(                              'Delete',                              style: TextStyle(color: theme.colorScheme.error),                            ),                          ],                        ),                      ),                    ],                    child: CustomIconWidget(                      iconName: 'more_vert',                      color: theme.colorScheme.onSurfaceVariant,                      size: 20,                    ),                  ),                ],              ),              SizedBox(height: 2.h),              Row(                children: [                  CustomIconWidget(                    iconName: 'text_fields',                    color: theme.colorScheme.onSurfaceVariant,                    size: 14,                  ),                  SizedBox(width: 1.w),                  Text(                    '$wordCount words',                    style: theme.textTheme.labelSmall?.copyWith(                      color: theme.colorScheme.onSurfaceVariant,                    ),                  ),                  SizedBox(width: 4.w),                  CustomIconWidget(                    iconName: 'schedule',                    color: theme.colorScheme.onSurfaceVariant,                    size: 14,                  ),                  SizedBox(width: 1.w),                  Text(                    timeAgo,                    style: theme.textTheme.labelSmall?.copyWith(                      color: theme.colorScheme.onSurfaceVariant,                    ),                  ),                ],              ),              SizedBox(height: 1.h),              Row(                children: [                  Expanded(                    child: LinearProgressIndicator(                      value: progress,                      backgroundColor:                      theme.colorScheme.outline.withValues(alpha: 0.2),                      valueColor: AlwaysStoppedAnimation<Color>(                        theme.colorScheme.primary,                      ),                    ),                  ),                  SizedBox(width: 2.w),                  Text(                    '${(progress * 100).toInt()}%',                    style: theme.textTheme.labelSmall?.copyWith(                      color: theme.colorScheme.onSurfaceVariant,                      fontWeight: FontWeight.w500,                    ),                  ),                ],              ),            ],          ),        ),      ),    );  }  void _showDeleteConfirmation(      BuildContext context, Map<String, dynamic> draft) {    final theme = Theme.of(context);    showDialog(      context: context,      builder: (context) => AlertDialog(        title: Text(          'Delete Draft',          style: theme.textTheme.titleLarge,        ),        content: Text(          'Are you sure you want to delete this draft? This action cannot be undone.',          style: theme.textTheme.bodyMedium,        ),        actions: [          TextButton(            onPressed: () => Navigator.pop(context),            child: const Text('Cancel'),          ),          ElevatedButton(            onPressed: () {              Navigator.pop(context);              onDraftDeleted(draft);            },            style: ElevatedButton.styleFrom(              backgroundColor: theme.colorScheme.error,              foregroundColor: theme.colorScheme.onError,            ),            child: const Text('Delete'),          ),        ],      ),    );  }}