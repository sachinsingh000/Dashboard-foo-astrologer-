import 'package:flutter/material.dart';import 'package:flutter/services.dart';/// Custom AppBar widget for the astrology consultation application/// Provides consistent navigation and branding across all screensclass CustomAppBar extends StatelessWidget implements PreferredSizeWidget {  /// The title to display in the app bar  final String? title;  /// Custom title widget (overrides title string if provided)  final Widget? titleWidget;  /// Leading widget (usually back button or menu icon)  final Widget? leading;  /// List of action widgets to display on the right side  final List<Widget>? actions;  /// Whether to show the back button automatically  final bool automaticallyImplyLeading;  /// Background color of the app bar  final Color? backgroundColor;  /// Foreground color for text and icons  final Color? foregroundColor;  /// Elevation of the app bar  final double? elevation;  /// Whether to center the title  final bool centerTitle;  /// Custom bottom widget (like TabBar)  final PreferredSizeWidget? bottom;  /// Flexible space widget for custom layouts  final Widget? flexibleSpace;  /// System overlay style for status bar  final SystemUiOverlayStyle? systemOverlayStyle;  /// Callback for leading widget press  final VoidCallback? onLeadingPressed;  /// App bar variant type  final CustomAppBarVariant variant;  const CustomAppBar({    super.key,    this.title,    this.titleWidget,    this.leading,    this.actions,    this.automaticallyImplyLeading = true,    this.backgroundColor,    this.foregroundColor,    this.elevation,    this.centerTitle = true,    this.bottom,    this.flexibleSpace,    this.systemOverlayStyle,    this.onLeadingPressed,    this.variant = CustomAppBarVariant.standard,  });  /// Standard app bar for most screens  const CustomAppBar.standard({    super.key,    required this.title,    this.actions,    this.onLeadingPressed,  })  : titleWidget = null,        leading = null,        automaticallyImplyLeading = true,        backgroundColor = null,        foregroundColor = null,        elevation = null,        centerTitle = true,        bottom = null,        flexibleSpace = null,        systemOverlayStyle = null,        variant = CustomAppBarVariant.standard;  /// Consultation app bar with availability indicator  const CustomAppBar.consultation({    super.key,    required this.title,    this.actions,    this.onLeadingPressed,  })  : titleWidget = null,        leading = null,        automaticallyImplyLeading = true,        backgroundColor = null,        foregroundColor = null,        elevation = null,        centerTitle = true,        bottom = null,        flexibleSpace = null,        systemOverlayStyle = null,        variant = CustomAppBarVariant.consultation;  /// Dashboard app bar with profile and notifications  const CustomAppBar.dashboard({    super.key,    required this.title,  })  : titleWidget = null,        leading = null,        actions = null,        automaticallyImplyLeading = false,        backgroundColor = null,        foregroundColor = null,        elevation = null,        centerTitle = false,        bottom = null,        flexibleSpace = null,        systemOverlayStyle = null,        onLeadingPressed = null,        variant = CustomAppBarVariant.dashboard;  /// Minimal app bar for focused experiences  const CustomAppBar.minimal({    super.key,    this.title,    this.onLeadingPressed,  })  : titleWidget = null,        leading = null,        actions = null,        automaticallyImplyLeading = true,        backgroundColor = null,        foregroundColor = null,        elevation = 0,        centerTitle = true,        bottom = null,        flexibleSpace = null,        systemOverlayStyle = null,        variant = CustomAppBarVariant.minimal;  /// Search app bar with search functionality  const CustomAppBar.search({    super.key,    this.onLeadingPressed,  })  : title = null,        titleWidget = null,        leading = null,        actions = null,        automaticallyImplyLeading = true,        backgroundColor = null,        foregroundColor = null,        elevation = null,        centerTitle = true,        bottom = null,        flexibleSpace = null,        systemOverlayStyle = null,        variant = CustomAppBarVariant.search;  @override  Widget build(BuildContext context) {    final theme = Theme.of(context);    return AppBar(      title: _buildTitle(context),      leading: _buildLeading(context),      actions: _buildActions(context),      automaticallyImplyLeading: automaticallyImplyLeading,      backgroundColor: backgroundColor ?? theme.appBarTheme.backgroundColor,      foregroundColor: foregroundColor ?? theme.appBarTheme.foregroundColor,      elevation: elevation ?? theme.appBarTheme.elevation,      centerTitle: centerTitle,      bottom: bottom,      flexibleSpace: flexibleSpace,      systemOverlayStyle: systemOverlayStyle ?? _getSystemOverlayStyle(context),    );  }  Widget? _buildTitle(BuildContext context) {    if (titleWidget != null) return titleWidget;    if (title == null) return null;    switch (variant) {      case CustomAppBarVariant.consultation:        return Row(          mainAxisSize: MainAxisSize.min,          children: [            Text(title!),            const SizedBox(width: 8),            Container(              width: 8,              height: 8,              decoration: BoxDecoration(                color: Theme.of(context).colorScheme.tertiary,                shape: BoxShape.circle,              ),            ),          ],        );      case CustomAppBarVariant.search:        return Container(          height: 40,          decoration: BoxDecoration(            color: Theme.of(context).colorScheme.surface,            borderRadius: BorderRadius.circular(20),            border: Border.all(              color: Theme.of(context).colorScheme.outline,              width: 1,            ),          ),          child: TextField(            decoration: InputDecoration(              hintText: 'Search consultations...',              prefixIcon: Icon(                Icons.search,                color: Theme.of(context).colorScheme.onSurfaceVariant,                size: 20,              ),              border: InputBorder.none,              contentPadding: const EdgeInsets.symmetric(                horizontal: 16,                vertical: 8,              ),            ),            style: Theme.of(context).textTheme.bodyMedium,          ),        );      default:        return Text(title!);    }  }  Widget? _buildLeading(BuildContext context) {    if (leading != null) return leading;    if (!automaticallyImplyLeading) return null;    switch (variant) {      case CustomAppBarVariant.dashboard:        return Padding(          padding: const EdgeInsets.all(8.0),          child: CircleAvatar(            backgroundColor: Theme.of(context).colorScheme.primary,            child: Icon(              Icons.person,              color: Theme.of(context).colorScheme.onPrimary,              size: 20,            ),          ),        );      default:        if (Navigator.of(context).canPop()) {          return IconButton(            icon: const Icon(Icons.arrow_back),            onPressed: onLeadingPressed ?? () => Navigator.of(context).pop(),          );        }        return null;    }  }  List<Widget>? _buildActions(BuildContext context) {    if (actions != null) return actions;    switch (variant) {      case CustomAppBarVariant.dashboard:        return [          IconButton(            icon: Stack(              children: [                const Icon(Icons.notifications_outlined),                Positioned(                  right: 0,                  top: 0,                  child: Container(                    width: 8,                    height: 8,                    decoration: BoxDecoration(                      color: Theme.of(context).colorScheme.error,                      shape: BoxShape.circle,                    ),                  ),                ),              ],            ),            onPressed: () =>                Navigator.pushNamed(context, '/consultation-requests-screen'),          ),          IconButton(            icon: const Icon(Icons.settings_outlined),            onPressed: () =>                Navigator.pushNamed(context, '/profile-management-screen'),          ),        ];      case CustomAppBarVariant.consultation:        return [          IconButton(            icon: const Icon(Icons.more_vert),            onPressed: () => _showConsultationMenu(context),          ),        ];      case CustomAppBarVariant.standard:        return [          IconButton(            icon: const Icon(Icons.search),            onPressed: () =>                Navigator.pushNamed(context, '/consultation-requests-screen'),          ),        ];      default:        return null;    }  }  void _showConsultationMenu(BuildContext context) {    showModalBottomSheet(      context: context,      builder: (context) => Container(        padding: const EdgeInsets.all(16),        child: Column(          mainAxisSize: MainAxisSize.min,          children: [            ListTile(              leading: const Icon(Icons.schedule),              title: const Text('Schedule Consultation'),              onTap: () {                Navigator.pop(context);                Navigator.pushNamed(context, '/consultation-requests-screen');              },            ),            ListTile(              leading: const Icon(Icons.report),              title: const Text('Generate Report'),              onTap: () {                Navigator.pop(context);                Navigator.pushNamed(context, '/report-editor-screen');              },            ),            ListTile(              leading: const Icon(Icons.account_balance_wallet),              title: const Text('View Earnings'),              onTap: () {                Navigator.pop(context);                Navigator.pushNamed(context, '/wallet-and-earnings-screen');              },            ),          ],        ),      ),    );  }  SystemUiOverlayStyle _getSystemOverlayStyle(BuildContext context) {    final brightness = Theme.of(context).brightness;    return brightness == Brightness.light        ? SystemUiOverlayStyle.dark        : SystemUiOverlayStyle.light;  }  @override  Size get preferredSize => Size.fromHeight(    kToolbarHeight + (bottom?.preferredSize.height ?? 0.0),  );}/// Enum defining different app bar variantsenum CustomAppBarVariant {  /// Standard app bar for most screens  standard,  /// Dashboard app bar with profile and notifications  dashboard,  /// Consultation app bar with availability indicator  consultation,  /// Minimal app bar for focused experiences  minimal,  /// Search app bar with search functionality  search,}